# Обзор проекта MedAnalyzer

## 1. Цель проекта

Проект MedAnalyzer представляет собой веб-сервис для интеллектуального анализа симптомов с использованием искусственного интеллекта. Пользователи вводят свои симптомы, возраст и пол, после чего система делает API-запрос к внешнему медицинскому API для получения предварительных данных. Эти данные затем анализируются с помощью Google Gemini Flash 2.5 API, который генерирует структурированный и понятный для пользователя отчет, включающий предварительную оценку, возможные причины, уровень срочности, рекомендации и рекомендации по обращению к врачу.

Основная цель — предоставить пользователям быстрый и информативный инструмент для понимания их симптомов, но с обязательным предупреждением о том, что это не заменяет профессиональную медицинскую консультацию.

## 2. Используемый технологический стек

*   **Фронтенд и Бэкенд:** Next.js (React Framework)
    *   Позволяет создавать полнофункциональные веб-приложения с рендерингом на стороне сервера (SSR) и API-маршрутами.
    *   Использует TypeScript для повышения надежности кода.
*   **Стилизация:** CSS (встроенный в Next.js, с возможностью использования Tailwind CSS, если проект был инициализирован с ним).
*   **Хостинг и Развертывание:** Vercel
    *   Обеспечивает бесшовное развертывание Next.js приложений.
    *   Поддерживает автоматическое развертывание из GitHub.
*   **Внешние API:**
    *   **AI Medical Diagnosis API | Symptoms to Results (RapidAPI):** Используется для получения первичных медицинских данных на основе введенных симптомов.
    *   **Google Gemini Flash 2.5 API:** Применяется для глубокого анализа данных, полученных от медицинского API, и генерации человекопонятных результатов.
*   **HTTP-клиент:** Axios (для выполнения HTTP-запросов к внешним API).

## 3. Архитектура приложения

Приложение MedAnalyzer имеет архитектуру Full-Stack, реализованную на Next.js:

*   **Фронтенд (Client-side):**
    *   Пользовательский интерфейс реализован в `src/app/page.tsx` с использованием React-компонентов.
    *   Собирает данные от пользователя через форму (возраст, пол, основная жалоба, дополнительные симптомы, длительность).
    *   Отправляет эти данные на серверный API-мармаршрут `/api/analyze` с помощью `fetch`.
    *   Отображает полученные от бэкенда результаты анализа.
*   **Бэкенд (Server-side - Next.js API Route):**
    *   Реализован в `src/app/api/analyze/route.ts`.
    *   Принимает POST-запросы от фронтенда.
    *   Выполняет первый внешний API-запрос к RapidAPI с использованием `axios` и `RAPIDAPI_KEY`.
    *   Обрабатывает ответ от RapidAPI и формирует промпт для Gemini API.
    *   Выполняет второй внешний API-запрос к Google Gemini Flash 2.5 API с использованием `@google/generative-ai` и `GEMINI_API_KEY`.
    *   Парсит JSON-ответ от Gemini и возвращает его на фронтенд.

## 4. Логика работы API-маршрута `/api/analyze`

1.  **Получение данных:** Маршрут получает JSON-объект с `age`, `gender`, `mainComplaint`, `additionalSymptoms` и `duration` из тела запроса.
2.  **Вызов RapidAPI:**
    *   Формируется запрос к `https://ai-medical-diagnosis-api-symptoms-to-results.p.rapidapi.com/api/v1/diagnosis`.
    *   В заголовки добавляются `x-rapidapi-key` и `x-rapidapi-host`.
    *   Тело запроса включает `age`, `gender`, объединенные `symptoms` и `duration`.
3.  **Формирование промпта для Gemini:**
    *   На основе данных пациента и ответа от RapidAPI генерируется подробный промпт для Gemini.
    *   Промпт запрашивает структурированный JSON-ответ с ключами: `preliminaryAssessment`, `possibleCauses`, `urgencyLevel`, `recommendations`, `doctorRecommendation`.
    *   В промпт включено обязательное предупреждение о том, что анализ не является медицинским диагнозом.
4.  **Вызов Gemini API:**
    *   Используется клиент `@google/generative-ai` для взаимодействия с моделью `gemini-1.5-flash`.
    *   Отправляется сформированный промпт.
5.  **Обработка ответа Gemini:**
    *   Полученный текстовый ответ от Gemini парсится как JSON.
    *   В случае успешного парсинга, JSON-объект возвращается фронтенду.
    *   В случае ошибки парсинга или других проблем, возвращается соответствующее сообщение об ошибке.

## 5. Ключевые файлы проекта

*   `medanalyzer-service/src/app/page.tsx`: Основной React-компонент фронтенда, содержащий форму и логику отображения результатов.
*   `medanalyzer-service/src/app/globals.css`: Глобальные стили CSS, импортированные из оригинального шаблона.
*   `medanalyzer-service/src/app/api/analyze/route.ts`: Серверный API-маршрут, обрабатывающий запросы к внешним API и Gemini.
*   `medanalyzer-service/.env.local`: Файл для хранения переменных окружения (API-ключей) для локальной разработки.
*   `medanalyzer-service/package.json`: Конфигурация проекта, скрипты и зависимости.
*   `medanalyzer-service/SECURITY_RECOMMENDATIONS.md`: Документ с рекомендациями по безопасности.
*   `medanalyzer-service/BACKEND_GUIDE.md`: Документ с инструкцией по использованию бэкенд API (будет создан).
